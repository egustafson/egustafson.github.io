<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>MediaWiki with Lighttpd & SQLite on Ubuntu</title>
        <link rel="stylesheet" href="https://egustafson.github.io/theme/css/main.css" />
        <link href="https://egustafson.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Stuff I've Figured Out Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://egustafson.github.io/">Stuff I've Figured Out  <strong>A catalog of technical solutions, or hackery -- you decide.</strong></a></h1>
                <nav><ul>
                    <li class="active"><a href="https://egustafson.github.io/category/howto.html">HowTo</a></li>
                    <li><a href="https://egustafson.github.io/category/random.html">Random</a></li>
                    <li><a href="https://egustafson.github.io/category/review.html">Review</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://egustafson.github.io/mediawiki-lighttpd-sqlite.html" rel="bookmark"
           title="Permalink to MediaWiki with Lighttpd & SQLite on Ubuntu">MediaWiki with Lighttpd <span class="amp">&amp;</span> SQLite on&nbsp;Ubuntu</a></h1>
<a href="http://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="elfwerks">Tweet</a><script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2012-02-18T00:00:00">
                Published: Sat 18 February 2012
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://egustafson.github.io/author/eric-gustafson.html">Eric Gustafson</a>
        </address>
<p>In <a href="https://egustafson.github.io/category/howto.html">HowTo</a>. </p>
<p>tags: <a href="https://egustafson.github.io/tag/lighttpd.html">lighttpd</a> <a href="https://egustafson.github.io/tag/sqlite.html">sqlite</a> <a href="https://egustafson.github.io/tag/mediawiki.html">mediawiki</a> <a href="https://egustafson.github.io/tag/wiki.html">wiki</a> </p>
</footer><!-- /.post-info -->      <p>In rebuilding an old, and rarely used server that runs <a class="reference external" href="https://www.mediawiki.org/">MediaWiki</a> I
reconsidered how to install all of the dependencies that MediaWiki
sits on top of. My goal was to choose lightweight components. The only
thing that would run on this web server would be MediaWiki, and the
wiki would be lightly used. I concluded the following components were
likely more suitable choices than the defaults MediaWiki and/or
Ubuntu’s package system&nbsp;used.</p>
<ul class="simple">
<li><a class="reference external" href="http://www.lighttpd.net">Lighttpd</a></li>
<li><a class="reference external" href="https://www.sqlite.org">SQLite</a></li>
</ul>
<p>The second goal was, based on my preference for Ubuntu as a
distribution, build MediaWiki on top of Ubuntu using just Ubuntu
packages, no source installation. The principal value in this is that
over time the components in use can be simply upgraded using the stock
Ubuntu package mechanisms (i.e. <code>apt-get upgrade</code>).</p>
<p>The following is the sequence I used to install MediaWiki. This
installation guide is based on Ubuntu Oneiric&nbsp;(11.10).</p>
<div class="section" id="install-prerequisites">
<h2>Install&nbsp;Prerequisites</h2>
<p>(note, <cite>sudo</cite> is generally required, but dropped from the commands&nbsp;below)</p>
<div class="highlight"><pre>apt-get install lighttpd
apt-get install php5-cgi php5
</pre></div>
<p>next, edit <tt class="docutils literal">/etc/php5/cgi/php.ini</tt> to enable php5 in lighttpd and
uncomment the&nbsp;line:</p>
<pre class="literal-block">
`cgi.fix_pathinfo=1`
</pre>
<p>Then enable the fastcgi configuration in&nbsp;lighttpd:</p>
<div class="highlight"><pre>lighttpd-enable-mod fastcgi
lighttpd-enable-mod fastcgi-php
service lighttpd force-reload
</pre></div>
<p>Install&nbsp;php5-sqlite:</p>
<div class="highlight"><pre>apt-get install php5-sqlite
service lighttpd restart
</pre></div>
<p>Install optional extras that MediaWiki will take advantage&nbsp;of:</p>
<div class="highlight"><pre>apt-get install imagemagick php5-gd php5-cli
service lighttpd restart
</pre></div>
</div>
<div class="section" id="install-mediawiki">
<h2>Install&nbsp;MediaWiki</h2>
<p>Note: The MediaWiki package in Ubuntu (Oneiric) has &#8216;mysql-server’
listed as a ’<em>recommends</em>’ dependency. This has the implication that
unless explicitly forced to <strong>not</strong> include the dependency, it will be
included as part of the package install. This is accomplished with the
<tt class="docutils literal"><span class="pre">--no-install-recommends</span></tt>.</p>
<div class="highlight"><pre>apt-get --no-install-recommends install mediawiki
apt-get install mediawiki-math
</pre></div>
</div>
<div class="section" id="configure-mediawiki">
<h2>Configure&nbsp;MediaWiki</h2>
<p>Add the following to lighttpd&#8217;s&nbsp;configuration:</p>
<div class="highlight"><pre>alias.url += ( &quot;/wiki&quot; =&gt; &quot;/var/lib/mediawiki/&quot; )
</pre></div>
<p>restart lighttpd to effect the configuration&nbsp;change:</p>
<div class="highlight"><pre>service lighttpd restart
</pre></div>
<p>Create a data directory for MediaWiki to store the SQLite database&nbsp;in:</p>
<div class="highlight"><pre>mkdir /var/lib/mediawiki-data
chown www-data.www-data /var/lib/mediawiki-data
</pre></div>
<p>Browse to the wiki root: <tt class="docutils literal"><span class="pre">http://hostname/wiki</span></tt> and complete
configuration through the web&nbsp;browser.</p>
<blockquote>
&#8230;</blockquote>
<p>Following browser configuration, copy the generated configuration to
the permanent location, as specified on the final browser&nbsp;page:</p>
<div class="highlight"><pre>cp /var/lib/mediawiki/config/LocalSettings.php /etc/mediawiki/LocalSettings.php
chown www-data /etc/mediawiki/LocalSettings.php
chmod 600 /etc/mediawiki/LocalSettings.php
rm -rf /var/lib/mediawiki/config
</pre></div>
<p>Done.</p>
</div>

    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="http://ipv6-address.eu/">IPv6 Check</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://egustafson.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="http://twitter.com/elfwerks">twitter</a></li>
                            <li><a href="http://delicious.com/elfwerks">delicious</a></li>
                            <li><a href="http://www.linkedin.com/in/ericggustafson/">linkedin</a></li>
                            <li><a href="https://github.com/egustafson">github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>