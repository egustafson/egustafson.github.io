<!DOCTYPE html>
<html lang="en"
>
<head>
    <title>Syncthing on Ubuntu - Stuff I've Figured Out</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://egustafson.github.io/syncthing-ubuntu.html">

        <meta name="author" content="Eric Gustafson" />
        <meta name="keywords" content="install,ubuntu,sync,syncthing" />
        <meta name="description" content="Last month, after looking at BitTorrent Sync and realizing it was encrypted and private, but not open source, I went digging for an alternative. I found the perfect project, for me: Syncthing. The project is still relatively young and while it has proven to be perfectly functional, it did not ..." />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://egustafson.github.io/theme/css/bootstrap.flatly.min.css" type="text/css"/>
    <link href="https://egustafson.github.io/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://egustafson.github.io/theme/css/pygments/manni.css" rel="stylesheet">
        <link href="https://egustafson.github.io/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="https://egustafson.github.io/theme/css/style.css" type="text/css"/>

        <link href="https://egustafson.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Stuff I've Figured Out ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://egustafson.github.io/" class="navbar-brand">
Stuff I've Figured Out            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                        <li class="active">
                            <a href="https://egustafson.github.io/category/howto.html">Howto</a>
                        </li>
                        <li >
                            <a href="https://egustafson.github.io/category/random.html">Random</a>
                        </li>
                        <li >
                            <a href="https://egustafson.github.io/category/review.html">Review</a>
                        </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="https://egustafson.github.io/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://egustafson.github.io/syncthing-ubuntu.html"
                       rel="bookmark"
                       title="Permalink to Syncthing on Ubuntu">
                        Syncthing on&nbsp;Ubuntu
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2015-01-09T00:00:00"> Fri 09 January 2015</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="https://egustafson.github.io/tag/install.html">install</a>
        /
	<a href="https://egustafson.github.io/tag/ubuntu.html">ubuntu</a>
        /
	<a href="https://egustafson.github.io/tag/sync.html">sync</a>
        /
	<a href="https://egustafson.github.io/tag/syncthing.html">syncthing</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Last month, after looking at <a class="reference external" href="http://www.getsync.com/">BitTorrent Sync</a> and realizing it was
encrypted and private, but <em>not</em> open source, I went digging for an
alternative.  I found the perfect project, for me:  <a class="reference external" href="http://syncthing.net/">Syncthing</a>.  The
project is still relatively young and while it has proven to be
perfectly functional, it did not come with batteries included &#8212; an
installer package.   It does come with init scripts for some
environments, but not for Ubuntu &#8212; at least until Ubuntu transitions
to systemd.  So, without further ado, here&#8217;s what I did to install
Syncthing as daemon (service) under&nbsp;Ubuntu.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Run as:</th><td class="field-body">User: &#8216;synct&#8217; // Group: &#8216;synct&#8217;</td>
</tr>
<tr class="field"><th class="field-name">Service Name:</th><td class="field-body">syncthing</td>
</tr>
<tr class="field"><th class="field-name">Install to:</th><td class="field-body">/opt/syncthing</td>
</tr>
<tr class="field"><th class="field-name">Config:</th><td class="field-body">/opt/syncthing/etc</td>
</tr>
<tr class="field"><th class="field-name"><span class="caps">GUI</span>:</th><td class="field-body">Exposed at 0.0.0.0:8080</td>
</tr>
<tr class="field"><th class="field-name">Public Access:</th><td class="field-body">Firewall port redirect.</td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<p>There&#8217;s nothing out of the ordinary about installing Syncthing as a service.
Above are the details I chose for how I&#8217;d install the service.  There are two
points are worth noting.  First, after the initial install the service&#8217;s
configuration is editable through the web-gui; the <span class="caps">XML</span> config will be in
/opt/syncthing/etc.  Second, sync-able repositories do not have to live in the
installation directory.  Installing is mostly about creating the extra fluff
needed to have init start the&nbsp;binary.</p>
<p>A reminder - this is aimed at an <strong>Ubuntu</strong> system.  Specifically, 14.10
(Utopic) was used, although earlier versions should work too.  When Ubuntu
transitions to systemd as an init system, the included Upstart script will not
be applicable.  (Current rumor is that the transition will be in the next
release &#8212; caveat&nbsp;emptor)</p>
<div class="section" id="create-user-and-group-for-the-daemon">
<h2>1. Create User and Group for the&nbsp;Daemon</h2>
<div class="highlight"><pre><span class="c">## add home dir first so adduser does not populate it with skel files.</span>
sudo mkdir /opt/syncthing
sudo mkdir /opt/syncthing/etc
sudo adduser --system --group --home /opt/syncthing synct
sudo chown -R synct.synct /opt/syncthing
</pre></div>
<p>The <tt class="docutils literal">synct</tt> group provides the opportunity to add authorized users to make
&#8216;syncable&#8217; folders with the <tt class="docutils literal">synct</tt> group.  Those users can manage their
folder(s) with out the need for sudo/root&nbsp;privilege.</p>
</div>
<div class="section" id="install-the-syncthing-binary">
<h2>2. Install the Syncthing&nbsp;Binary</h2>
<p>Fetch the binary from the <a class="reference external" href="https://github.com/syncthing/syncthing">Syncthing GitHub Project</a>.  The releases <span class="caps">URL</span> is:
<a class="reference external" href="https://github.com/syncthing/syncthing/releases">https://github.com/syncthing/syncthing/releases</a>.  Download the tarball
appropriate for your architecture.  (The example uses <tt class="docutils literal">amd64</tt>, and version&nbsp;0.10.18)</p>
<div class="highlight"><pre><span class="nb">cd</span> /tmp
tar -xvf /path-to/syncthing-linux-amd64-v0.10.18.tar.gz
sudo mkdir /opt/syncthing/bin
sudo cp syncthing-linux-amd64-v0.10.18/syncthing /opt/syncthing/bin
</pre></div>
<p>The only file needed from the release tarball is the executable itself.  The
executable is tar&#8217;ed with execute permission, but it never hurts to verify its&nbsp;executable.</p>
</div>
<div class="section" id="install-an-upstart-script">
<h2>4. Install an Upstart&nbsp;&quot;Script&quot;</h2>
<p>Install the following Upstart configuration file in <tt class="docutils literal">/etc/init/syncthing.conf</tt></p>
<div class="highlight"><pre>description  &quot;syncthing daemon&quot;
author       &quot;Eric Gustafson &lt;egustafson in launchpad&gt;&quot;

start on (local-filesystems and net-device-up IFACE!=lo)
stop on runlevel [!2345]

setuid synct
setgid synct

env HOME=/opt/syncthing

exec /opt/syncthing/bin/syncthing -home /opt/syncthing/etc
</pre></div>
<p>A couple of notes on the conf&nbsp;file:</p>
<ol class="arabic simple">
<li>Setting the <tt class="docutils literal"><span class="caps">HOME</span></tt> env lets syncthing know where to create the default,
<tt class="docutils literal">Sync</tt> folder on initial start-up.  I had problems before I added this&nbsp;stanza.</li>
<li>Using the &quot;<tt class="docutils literal"><span class="pre">-home</span> /opt/syncthing/etc</tt>&quot; flag instructs syncthing to place
all configuration files <em>directly</em> into the <tt class="docutils literal">etc</tt> directory.  If this flag
is missing it will place the configuration in a hidden directory under
<tt class="docutils literal">$<span class="caps">HOME</span></tt>.</li>
</ol>
<p>It would be nice to get a list of supported environment variables and command
line switches, but the docs are not there yet.  Conversely, I could &quot;read the
source luke&quot;, so I should stop whining and go contribute&nbsp;;)</p>
</div>
<div class="section" id="start-and-verify-the-service">
<h2>5. Start and Verify the&nbsp;Service</h2>
<p>If the stars are aligned, then the service will&nbsp;start:</p>
<div class="highlight"><pre>sudo service syncthing start
sudo tail -f /var/log/upstart/syncthing.log
</pre></div>
<p>At this point the service is (hopefully) up.  There is a small problem, however:
the configuration created on first-run restricts the web-gui to loopback only
(127.0.0.1).  This is fine if the machine is your desktop, but can be a snag if
its remote.  The config file can be edited by hand to change&nbsp;this.</p>
<p>In preparation for changing the listening address for the&nbsp;web-gui:</p>
<div class="highlight"><pre>sudo service syncthing stop
</pre></div>
</div>
<div class="section" id="modify-the-configuration-to-expose-the-web-gui">
<h2>6. Modify the Configuration to expose the Web <span class="caps">GUI</span></h2>
<p>Edit the config file:  <tt class="docutils literal">/opt/syncthing/etc/config.xml</tt></p>
<div class="highlight"><pre><span class="c">## syncthing changes the permissions on etc, sudo is required</span>
sudo emacs /opt/syncthing/etc/config.xml
</pre></div>
<p>The following line should be changed as depicted.  The important aspect is to
change the <tt class="docutils literal">127.0.0.1</tt> to the wildcard address, <tt class="docutils literal">0.0.0.0</tt>.  [The port could
be changed too, if need&nbsp;be.]</p>
<div class="highlight"><pre><span class="nt">&lt;gui</span> <span class="na">enabled=</span><span class="s">&quot;true&quot;</span> <span class="na">tls=</span><span class="s">&quot;false&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;address&gt;</span>0.0.0.0:8080<span class="nt">&lt;/address&gt;</span>
    ...
<span class="nt">&lt;/gui&gt;</span>
</pre></div>
<p>Now restart the&nbsp;service</p>
<div class="highlight"><pre>sudo service syncthing start
</pre></div>
<p>and point a web browser at port 8080 of the&nbsp;host.</p>
</div>
<div class="section" id="optional-firewall-port-redirect">
<h2>7. (Optional) Firewall Port&nbsp;Redirect</h2>
<p>At this point you have a perfectly good, working Syncthing &#8212;&nbsp;congratulations.</p>
<p>However, if your host is behind a firewall it may not be reachable for
sync-ing.  The first point:  if you have a consumer firewall that supports UPnP
then Syncthing is likely visible as it supports, and enables by default, UPnP.
If you don&#8217;t have UPnP enabled on your firewall or the Syncthing instance is not
visible then following the &quot;<a class="reference external" href="https://github.com/syncthing/syncthing/wiki/Firewalls-and-Port-Forwards">Firewalls and Port Forwards</a>&quot; instructions on the
<a class="reference external" href="https://github.com/syncthing/syncthing/wiki">wiki</a> will help you resolve the&nbsp;issue.</p>
<p>In short: plumb <span class="caps">TCP</span> port 22000 through from your firewall to the server.  Port
22000 is the default port for the Block Exchange Protocol <a class="footnote-reference" href="#id2" id="id1">[1]</a> (<span class="caps">BEP</span>), and the
only port necessary for a remote agent to connect with your&nbsp;server.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>The protocols Syncthing uses are documented here:  <a class="reference external" href="https://github.com/syncthing/specs">https://github.com/syncthing/specs</a></td></tr>
</tbody>
</table>
<hr class="docutils" />
<p>That&#8217;s it, you&#8217;re done.  Happy&nbsp;syncing.</p>
<!-- Local Variables: -->
<!-- fill-column: 80 -->
<!-- End: -->
</div>

            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'egustafson'; // required: replace example with your forum shortname

                    var disqus_identifier = 'syncthing-ubuntu';
                var disqus_url = 'https://egustafson.github.io/syncthing-ubuntu.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="http://twitter.com/elfwerks"><i class="fa fa-twitter-square fa-lg"></i> twitter</a></li>
                <li class="list-group-item"><a href="http://delicious.com/elfwerks"><i class="fa fa-delicious-square fa-lg"></i> delicious</a></li>
                <li class="list-group-item"><a href="http://www.linkedin.com/in/ericggustafson/"><i class="fa fa-linkedin-square fa-lg"></i> linkedin</a></li>
                <li class="list-group-item"><a href="https://github.com/egustafson"><i class="fa fa-github-square fa-lg"></i> github</a></li>
              </ul>
            </li>



            <li class="list-group-item"><a href="https://egustafson.github.io/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group list-inline tagcloud" id="tags">
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/blog.html">
                            blog
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/cgp.html">
                            CGP
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/collectd.html">
                            collectd
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/cygwin.html">
                            cygwin
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/dhcp.html">
                            DHCP
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/dns.html">
                            DNS
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/dnsmasq.html">
                            dnsmasq
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="https://egustafson.github.io/tag/freebsd.html">
                            FreeBSD
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/install.html">
                            install
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="https://egustafson.github.io/tag/ipv6.html">
                            IPv6
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="https://egustafson.github.io/tag/lighttpd.html">
                            lighttpd
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="https://egustafson.github.io/tag/linux.html">
                            Linux
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/mediawiki.html">
                            mediawiki
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/monitoring.html">
                            monitoring
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/nat.html">
                            NAT
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/oscon.html">
                            OSCON
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/pelican.html">
                            pelican
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/rfc2893.html">
                            RFC2893
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/sqlite.html">
                            sqlite
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/sync.html">
                            sync
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/syncthing.html">
                            syncthing
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/trip-report.html">
                            trip report
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/tunneling.html">
                            Tunneling
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/ubuntu.html">
                            ubuntu
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/vagrant.html">
                            Vagrant
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/virtualbox.html">
                            VirtualBox
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/virtualization.html">
                            virtualization
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/vmware.html">
                            VMWare
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="https://egustafson.github.io/tag/wiki.html">
                            wiki
                        </a>
                    </li>
                </ul>
            </li>
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://krow.net/" target="_blank">
                Brian Aker
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://linuxjedi.co.uk/" target="_blank">
                Andrew Hutchings
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://patg.net/" target="_blank">
                Patrick Galbraith
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://askyazz.com/" target="_blank">
                Yazz Atlas
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015 Eric Gustafson
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://egustafson.github.io/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://egustafson.github.io/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://egustafson.github.io/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'egustafson'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-59717139-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->
</body>
</html>