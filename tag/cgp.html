<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Stuff I've Figured Out - cgp</title>
        <link rel="stylesheet" href="https://egustafson.github.io/theme/css/main.css" />
        <link href="https://egustafson.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Stuff I've Figured Out Atom Feed" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://egustafson.github.io/">Stuff I've Figured Out  <strong>A catalog of technical solutions, or hackery -- you decide.</strong></a></h1>
                <nav><ul>
                    <li><a href="https://egustafson.github.io/category/blog.html">Blog</a></li>
                    <li><a href="https://egustafson.github.io/category/monitoring.html">Monitoring</a></li>
                    <li><a href="https://egustafson.github.io/category/web-sites.html">Web Sites</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="https://egustafson.github.io/collectd-web-graphs.html">Simple collectd with Web Graphs</a></h1>
<footer class="post-info">
        <abbr class="published" title="2012-04-10T00:00:00">
                Published: Tue 10 April 2012
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://egustafson.github.io/author/eric-gustafson.html">Eric Gustafson</a>
        </address>
<p>In <a href="https://egustafson.github.io/category/monitoring.html">Monitoring</a>. </p>
<p>tags: <a href="https://egustafson.github.io/tag/http.html">http</a> <a href="https://egustafson.github.io/tag/monitoring.html">monitoring</a> <a href="https://egustafson.github.io/tag/lighttpd.html">lighttpd</a> <a href="https://egustafson.github.io/tag/collectd.html">collectd</a> <a href="https://egustafson.github.io/tag/cgp.html">cgp</a> </p>
</footer><!-- /.post-info --><p>I want to collect machine metrics and I want to display them as a
pretty set of graphs through a web browser.  Here's how I do it:</p>
<ol class="arabic simple">
<li>Install <a class="reference external" href="http://collectd.org/">collectd</a> -- this gathers the metrics.</li>
<li>Install <a class="reference external" href="http://lighttpd.net/">lighttpd</a> -- my web server preference, also install php.</li>
<li>Download and install collectd graph panel (<a class="reference external" href="https://github.com/pommi/CGP">CGP</a>) -- a PHP webapp.</li>
</ol>
<p>That's the short version.</p>
<div class="section" id="installation">
<h2>Installation</h2>
<p>The following walk through will demonstrate the installation using
Ubuntu Oneiric (11.10). Note, the <tt class="docutils literal">sudo</tt> is generally required, but
dropped from the commands listed below:</p>
<div class="highlight"><pre>apt-get install collectd lighttpd php5-cgi php5
</pre></div>
<p>next, edit <tt class="docutils literal">/etc/php5/cgi/php.ini</tt> to enable php5 in lighttpd.
Uncomment the line &quot;<tt class="docutils literal">cgi.fix_pathinfo=1</tt>&quot;.</p>
<p>Restart lighttpd and you have a working lighttpd+php5.</p>
<div class="highlight"><pre>lighttpd-enable-mod fastcgi
lighttpd-enable-mod fastcgi-php
service lighttpd force-reload
</pre></div>
<p>Next, download and &quot;<cite>install</cite>&quot; collectd graph panel (CGP).  CGP is
downloaded with <tt class="docutils literal">git</tt>, if you do not have git installed then:</p>
<div class="highlight"><pre>apt-get install git
</pre></div>
<p>Download CGP into the lighttpd root directory:</p>
<div class="highlight"><pre><span class="nb">cd</span> /var/www
git clone http://git.nethuis.nl/pub/cgp.git
chown -R www-data.www-data cgp   <span class="c">## optional</span>
</pre></div>
<p>Done!  Browse to <a class="reference external" href="http://localhost/cgp/">http://localhost/cgp/</a> to access the graphs.</p>
</div>
<hr class="docutils" />
<div class="section" id="configuring-what-metrics-collectd-collects">
<h2>Configuring what metrics collectd collects</h2>
<p>The primary configuration for <a class="reference external" href="http://collectd.org/">collectd</a> as
Ubuntu installs it is placed in <tt class="docutils literal">/etc/collectd/collectd.conf</tt>.  The
configuration file is commented.  Refer to the collectd <a class="reference external" href="http://collectd.org/documentation.shtml">documentation</a>
page for further details.  For each plugin see the plugin pages listed
along the side of the documentation page.  Many plugins do not require
additional configuration -- simply uncommenting them is a good
starting point.</p>
<p>After editing the collectd configuration, the service must be
restarted with the typical service restart command:</p>
<div class="highlight"><pre>service collectd restart
</pre></div>
<p>Many of the plugins default to collecting all possible metrics covered
by the plugin.  It is possible, via the plugin's specific
configuration, to prune out unwanted metrics.  A good example of this
is the '<tt class="docutils literal">interfaces</tt>' plugin which includes statistics for the
loopback interface by default.</p>
</div>
<div class="section" id="customizing-cgp">
<h2>Customizing CGP</h2>
<p>The <a class="reference external" href="https://github.com/pommi/CGP">CGP</a> website does not provide any configuration documentation,
however it is not difficult to customize CGP.  If installed, as shown
above, CGP's configuration file will be:
<tt class="docutils literal">/var/www/cgp/conf/config.php</tt>.  This file is commented with details
for changing the configuration.</p>
</div>
<div class="section" id="adding-additional-hosts">
<h2>Adding additional hosts</h2>
<p>Nothing is required of CGP to add additional hosts.  Simply install
<a class="reference external" href="http://collectd.org/">collectd</a> on the additional machines and configure the <a class="reference external" href="http://collectd.org/wiki/index.php/Plugin:Network">network
plugin</a> on both the client and server.  In most cases, the commented
out configuration, which uses multicast, will suffice for configuring
the network plugin.</p>
<p>Now sit back and enjoy the pretty graphs of your running servers.</p>
</div>
                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="http://ipv6-address.eu/">IPv6 Check</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="https://egustafson.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="http://twitter.com/elfwerks">twitter</a></li>
                            <li><a href="http://delicious.com/elfwerks">delicious</a></li>
                            <li><a href="http://www.linkedin.com/in/ericggustafson/">linkedin</a></li>
                            <li><a href="https://github.com/egustafson">github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>